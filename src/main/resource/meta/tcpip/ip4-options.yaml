# Sly Technologies Free License
# 
# Copyright 2025 Sly Technologies Inc.
#
# This YAML file defines IPv4 options meta-templates for parsing and formatting
# various IPv4 header options including Router Alert, MTU, Security, Record Route,
# and other standard options defined in the IPv4 protocol specification.

Overview:
  description: >
    Defines templates and structures for IPv4 options formatting and analysis.

  defaults:
    indent: 4
    width: 50
    align: left

  macros:
    $opt_type: IPv4_OPT_TYPE

Templates:
  - header: Ip4Option
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4Option
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "IPv4 option \{length:bytes}"
        items:
          - field: type
            label: "Type"
            template: "\{:$opt_type} (\{value})"

  - header: Ip4RouterAlertOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4RouterAlertOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Router Alert (\{length:bytes}): \{alertValue}"
        items:
          - field: value
            label: "Alert Value"
            template: "\{value} (\{alertDescription})"

  - header: Ip4MtuProbeOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4MtuProbeOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "MTU Probe (\{length:bytes})"
        items:
          - field: mtu
            label: "MTU Size"
            template: "\{value} bytes"

  - header: Ip4MtuReplyOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4MtuReplyOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "MTU Reply (\{length:bytes})"
        items:
          - field: mtu
            label: "MTU Size"
            template: "\{value} bytes"

  - header: Ip4QuickStartOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4QuickStartOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Quick Start (\{length:bytes})"
        items:
          - field: function
            label: "Function"
            template: "\{value} (\{functionName})"
          - field: rate
            label: "Rate Request"
            template: "\{value} Kbps"

  - header: Ip4RecordRouteOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4RecordRouteOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Record Route (\{length:bytes})"
        items:
          - field: pointer
            label: "Pointer"
            template: "\{value}"
          - field: routeData
            label: "Route Data"
            template: "\{:IP4_ROUTE_DATA}"

  - header: Ip4SecurityDefunctOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4SecurityDefunctOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Security (\{length:bytes})"
        items:
          - field: security
            label: "Security Level"
            template: "\{value} (\{securityLevelName})"
          - field: compartments
            label: "Compartments"
            template: "\{value}"
          - field: restrictions
            label: "Handling Restrictions"
            template: "\{value}"

  - header: Ip4TimestampOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4TimestampOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Timestamp (\{length:bytes})"
        items:
          - field: pointer
            label: "Pointer"
            template: "\{value}"
          - field: overflow
            label: "Overflow"
            template: "\{value}"
          - field: flags
            label: "Flags"
            template: "\{value} (\{flagsDescription})"
          - field: timestamps
            label: "Timestamps"
            template: "\{:TIMESTAMP_DATA}"

  - header: Ip4TracerouteOption
    class: com.slytechs.jnet.protocol.tcpip.ip.Ip4TracerouteOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Traceroute (\{length:bytes})"
        items:
          - field: id
            label: "ID Number"
            template: "\{value}"
          - field: outbound
            label: "Outbound Hop Count"
            template: "\{value}"
          - field: return
            label: "Return Hop Count"
            template: "\{value}"
          - field: originator
            label: "Originator IP"
            template: "\{:IP4_ADDR}"