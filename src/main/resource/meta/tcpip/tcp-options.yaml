# Sly Technologies Free License
# 
# Copyright 2025 Sly Technologies Inc.
#
# This YAML file defines TCP option meta-templates for parsing and formatting 
# TCP header options. Includes definitions for MSS, SACK, Timestamps, Window 
# Scale and NOP options with their respective fields and formatting rules.
#
# The template provides consistent formatting across all TCP options while
# maintaining specific requirements for each option type. Priority settings
# ensure proper option processing order during packet analysis.

Overview:
  description: >
    Defines templates and structures for TCP protocol options formatting and analysis.

  defaults:
    indent: 4
    width: 50
    align: left

Templates:
  - header: TcpEolOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpEolOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "End of Option List"

  - header: TcpFastOpenOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpFastOpenOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "TCP Fast Open"

  - header: TcpMssOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpMssOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Maximum Segment Size Option"
        items:
          - field: mss
            label: "Max segment size"
            template: '\{value}'

  - header: TcpNopOption 
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpNopOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "No Operation (Padding)"

  - header: TcpOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "TCP Option"

  - header: TcpOptionId 
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpOptionId
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "TCP Option ID"

  - header: TcpSackOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpSackOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Selective ACK Option"

  - header: TcpSackPermittedOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpSackPermittedOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "SACK Permitted Option"

  - header: TcpTimestampOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpTimestampOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Timestamp Option"
        items:
          - field: tsValue
            label: "Timestamp"
            template: '\{:0x%x}'
            
          - field: tsEchoReply
            label: "Timestamp Echo Reply" 
            template: '\{:0x%x}'

  - header: TcpWindowScaleOption
    class: com.slytechs.jnet.protocol.tcpip.tcp.TcpWindowScaleOption
    meta:
      priority: 200
    details:
      - detail: HIGH
        summary: "Window Scale Option (bitshift)"
        items:
          - field: shiftCount
            label: "Window scale"
            template: '\{value} (multiply by \{multiplier})'