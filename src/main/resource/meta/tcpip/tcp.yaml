# Sly Technologies Free License
# 
# Copyright 2025 Sly Technologies Inc.
#
# This YAML file defines the TCP protocol meta-template structure used for packet 
# analysis and display. The template includes port numbers, sequence/ack numbers,
# flags, window sizes and all essential TCP header fields with comprehensive
# formatting options.
#
# The template supports multiple detail levels with inheritance, providing views
# from detailed header analysis to summary port information. It includes specialized
# formatters for port lookups, TCP flags, and bit field displays.

Overview:
  description: >
    Defines templates and structures for TCP protocol data formatting and analysis.

  defaults:
    indent: 4
    width: 50
    align: left

Templates:
  - header: Tcp
    class: com.slytechs.jnet.protocol.layer4.Tcp

    details:
      - detail: HIGH
        summary: 'Transmission Control Protocol, offset=\{offset} length=\{length}'
        items:
          - field: source
            label: "Source Port"
            template: '\{:PORT_LOOKUP} (\{value})'

          - field: destination
            label: "Destination Port" 
            template: '\{:PORT_LOOKUP} (\{value})'

          - field: seq
            label: "Sequence Number (raw)"
            template: '\{value}'

          - field: ack
            label: "Acknowledgment Number (raw)"
            template: '\{value}'

          - field: dataOffset
            label: "Header Length"
            template: '\{length} bytes (\{value})'

          - field: flags
            label: "Flags"
            template: '\{:0x%03x} (\{:TCP_FLAGS}) [\{:TCP_BITS}]'

          - field: window
            label: "Window"
            template: '\{value}'

          - field: checksum
            label: "Checksum"
            template: '\{value:0x%x}'

          - field: urgent
            label: "Urgent Pointer"
            template: '\{value}'

      - detail: MEDIUM
        summary: 'TCP \{source:PORT_LOOKUP} → \{destination:PORT_LOOKUP}'
        items:
          - field: flags
            label: "Flags"
            template: '\{:TCP_FLAGS}'

          - field: seq
            label: "Seq"
            template: '\{value}'

          - field: ack
            label: "Ack"
            template: '\{value}'

      - detail: SUMMARY
        summary: 'TCP \{destination:PORT_LOOKUP} → \{destination:PORT_LOOKUP}'