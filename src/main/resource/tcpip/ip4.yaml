IPv4:
  defaults:
    width: 50
    align: left

  templates:
    HIGH:
      summary: "Internet Protocol Version 4, offset=\{offset} length=\{length}"
      fields:
        - name: version
          label: ""
          template: "\{header[0]:1111 ....} = Version: \{value}"

        - name: hdrLen
          label: ""
          template: "\{header[0]:.... 1111} = Header Length: \{hdrLenBytes} bytes (\{value})"

        - name: trafficClass
          label: "Traffic Class"
          template: "0x\{value:02X} (DSCP: \{trafficDscpName}, ECN: \{trafficDscpAbbr})"

        - name: totalLength
          label: "Total Length"
          template: "\{value} bytes"

        - name: identification
          label: "Identification"
          template: "0x\{value:04X} [\{value}]"

        - name: flags
          label: ""
          template: "\{value:010. ....} = Flags: 0x\{value:HEX}, \{flagsInfo:NO_QUOTES}"
#		  010. .... = Flags: 0x2, Don't fragment
#		      0... .... = Reserved bit: Not set
#		      .1.. .... = Don't fragment: Set
#		      ..0. .... = More fragments: Not set

        - name: fragOffset
          label: "Fragment Offset"
          template: "\{value} [\{value}*8 = \{fragOffsetBytes} bytes]"

        - name: ttl
          label: "Time to Live"
          template: "\{value}"

        - name: protocol
          label: "Protocol"
          template: "\{protocol:IP_TYPE} (\{value})"

        - name: src
          label: "Source Address"
          template: "\{value}"

        - name: dst
          label: "Destination Address"
          template: "\{value}"

    MEDIUM:
      summary: "IPv4 \{src} → \{dst}, \{protocol}"
      fields:
        - name: trafficClass
          label: "Traffic Class"
          template: "0x\{value:02X} (DSCP: \{trafficDscpName}, ECN: \{trafficDscpAbbr})"

        - name: totalLength
          label: "Total Length"
          template: "\{value} bytes"

        - name: ttl
          label: "Time to Live"
          template: "\{value}"

        - name: protocol
          label: "Protocol"
          template: "\{protocol:IP_TYPE}"

    SUMMARY:
      summary: "IPv4 \{src} → \{dst} (\{protocol})"
